<!=OCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">

<head>
    <title>Dash Player</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
    <!-- dash player -->
    <script src="https://cdn.dashjs.org/latest/dash.all.min.js"></script>

    <script type="text/javascript" src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js" integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T"
        crossorigin="anonymous"></script>

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB"
        crossorigin="anonymous">

</head>
<style>
    body {
        background-color: #687174;
    }

    div#player {
        width: 800px;
        background: #000;
        margin: 0px auto;
    }

    div#video_controls_bar {
        background: #333;
        padding: 10px;
        color: #CCC
    }

    input#seekSlider {
        width: 400px;
    }

    input#volumeSlider {
        width: 80px;
    }

    input[type='range'] {
        -webkit-appearance: none !important;
        background: #666;
        height:4px;
    }
    input[type='range']::-webkit-slider-thumb {
        -webkit-appearance: none !important;
        background: #FFF;
        height:15px;
        width:15px;
        border-radius:100%;
        cursor:pointer;
    }

</style>

<body>
    <script type="text/javascript">
        var player1, firstLoad = true;
        var defaultkey = 'konf';
        var tech = 'dash';
        var file = "index.mpd",
            path, video;
        var playbtn, mutebtn, fullscreenbtn, seekSlider, curtimetext, durtimetext;

        function startStream() {
            firstLoad = false;
            //var inputkey = document.getElementById("stream_app").value;
            //if (inputkey != "") {
            //  key = inputkey;
            //} else {
            //  key = defaultkey;
            // }
            // path = tech + "/" + key + "/" + file;
            // path = "https://yt-dash-mse-test.commondatastorage.googleapis.com/media/motion-20120802-manifest.mpd";
            path = "https://yt-dash-mse-test.commondatastorage.googleapis.com/media/car-20120827-manifest.mpd"
            //video = document.getElementById("dash-video-player");
            video = document.querySelector("#dash-video-player");
            playbtn = document.getElementById("playpausebtn");
            seekSlider = document.getElementById("seekSlider");
            curtimetext = document.getElementById("curtimetext");
            durtimetext = document.getElementById("durtimetext");
            mutebtn = document.getElementById("mutebtn");
            volumeSlider = document.getElementById("volumeSlider");
            fullscreenbtn = document.getElementById("fullscreenbtn");

            // Add Events
            playbtn.addEventListener("click", playPause, false);
            seekSlider.addEventListener("change", vidSeek, false);
            video.addEventListener("timeupdate", seektimeupdate, false);
            mutebtn.addEventListener("click", vidmute, false);
            volumeSlider.addEventListener("change", setvolume, false);
            fullscreenbtn.addEventListener("click", toggleFullScreen, false);
            //document.querySelector('#gainSlider').addEventListener('change', function() {
            //  player1.setVolume(this.value)
            //  document.getElementById("volume_label").innerHTML = player1.getVolume();
            //  console.log(player1.getVolume())
            //}, false);
            player1 = dashjs.MediaPlayer().create();
            player1.initialize(video, path, true);
            //player1.setVolume(0.5);
            console.log(path);
        }

        function switchStream() {
            if (!firstLoad) {
                player1.reset();
            }
            firstLoad = false;
            //var inputkey = document.getElementById("stream_app").value;
            //if (inputkey != "") {
            //  key = inputkey;
            //} else {
            //  key = defaultkey;
            //}
            path = tech + "/" + key + "/" + file;
            video = document.querySelector("#dash-video-player");
            player1 = dashjs.MediaPlayer().create();
            player1.initialize(video, path, false);
        }





        function playPause() {
            if (video.paused) {
                video.play();
                playbtn.innerHTML = "Pause";
            } else {
                video.pause();
                playbtn.innerHTML = "Play";
            }

        }

        function vidSeek() {
            var seekto = video.duration * (seekSlider.value / 100);
            video.currentTime = seekto;
        }
        function seektimeupdate() {
            var nt = video.currentTime * (100 / video.duration);
            seekSlider.value = nt;
            var curmins = Math.floor(video.currentTime / 60);
            var cursecs = Math.floor(video.currentTime - curmins * 60);
            var durmins = Math.floor(video.duration / 60);
            var dursecs = Math.floor(video.duration - durmins * 60);
            if (cursecs < 10) {
                cursecs = "0" + cursecs;
            }
            if (dursecs < 10) {
                dursecs = "0" + dursecs;
            }
            if (curmins < 10) {
                curmins = "0" + curmins;
            }
            if (durmins < 10) {
                durmins = "0" + durmins;
            }

            curtimetext.innerHTML = curmins + ":" + cursecs;
            durtimetext.innerHTML = durmins + ":" + dursecs;
        }

        function vidmute() {
            if (video.muted) {
                video.muted = false;
                mutebtn.innerHTML = "Mute";
            } else {
                video.muted = true;
                mutebtn.innerHTML = "Unmute";
            }
        }

        function setvolume() {
            video.volume = volumeSlider.value / 100;

        }

        function toggleFullScreen() {

            if (video.requestFullScreen) {
                video.requestFullScreen();
            } else if (video.webkitRequestFullScreen) {
                video.webkitRequestFullScreen();
            } else if (video.mozRequestFullScreen) {
                video.mozRequestFullScreen();
            }
        }
    </script>

    <CENTER>
        <h2><b>Dynamic Dash Player</b></h2>
        <p></p>
        The <a href=hdw.html>HDW player</a> can be found on the hdw page The <a href=ihls.html>iPhone hls player</a> can
        be found on the iPhone page
        <p></p>
        <div id="player" class="video_container">
            <video id="dash-video-player" width="800" height="600" autoplay poster="/images/Metronom.gif">
            </video>
            <div id="video_controls_bar">
                <button id="playpausebtn" style="float:left;">Pause</button>

                <input id="seekSlider" type="range" min="0" max="100" value="0" step="1" />
                <span id="curtimetext">00:00</span> / <span id="durtimetext">00:00</span>
                <button id="mutebtn">Mute</button>
                <input id="volumeSlider" type="range" min="0" max="100" value="10" step="1" />
                <button id="fullscreenbtn">[ &nbsp; ]</button>
            </div>
        </div>
    </CENTER>
    <script type="text/javascript">
        document.addEventListener("DOMContentLoaded", function () {
            startStream();
        });
    </script>
    <!--div class="input-group" style="margin-top: 10px; margin-left: 10px; width: 240px;">
    <input type="text" name="stream_app" id="stream_app" required placeholder="Stream Name" class="form-control">
    <span class="input-group-btn input-btn">
      <button class="btn btn-default" id="form_button" type="button" onclick="switchStream()">Switch Stream</button>
   </span>
  </div-->

</body>

</html>